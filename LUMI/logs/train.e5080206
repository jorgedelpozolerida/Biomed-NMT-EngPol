INFO:__main__:Parameters: Namespace(base_dir='/scratch/project_465000872/DATA', config_path='../src/train_config.json', dataset_name='dataset_tokenized', filter_file=None, sample_size=10000, seed=42, source_lang='eng', target_lang='pol')
INFO:__main__:Methods: None, level: None
INFO:__main__:Started filtering dataset 'dataset_tokenized' using None file
INFO:__main__:	Size before filtering: 711720
INFO:__main__:	Size after filtering: 711720

INFO:__main__:Succesfully sampled 10000 sentences using seed=42
INFO:__main__:Performed stratified splits
INFO:__main__:	train_size: 8000, valid_size: 2000, test_size: 1283
INFO:__main__:Training configuration:
INFO:__main__:{
    "eval_steps": 100,
    "evaluation_strategy": "steps",
    "fp16": true,
    "greater_is_better": true,
    "load_best_model_at_end": true,
    "logging_steps": 25,
    "lr_scheduler_type": "linear",
    "metric_for_best_model": "bleu",
    "num_train_epochs": 5,
    "optim": "adamw_torch",
    "per_device_eval_batch_size": 20,
    "per_device_train_batch_size": 15,
    "save_strategy": "steps",
    "warmup_steps": 100,
    "weight_decay": 0.01
}
INFO:__main__:Starting training
  0%|          | 0/335 [00:00<?, ?it/s]/opt/conda/envs/conda_container_env/lib/python3.8/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
  0%|          | 1/335 [00:21<1:57:45, 21.15s/it]  1%|          | 2/335 [00:28<1:12:57, 13.15s/it]  1%|          | 3/335 [00:36<58:32, 10.58s/it]    1%|          | 4/335 [00:42<48:48,  8.85s/it]  1%|▏         | 5/335 [00:48<42:33,  7.74s/it]  2%|▏         | 6/335 [00:53<38:29,  7.02s/it]  2%|▏         | 7/335 [00:58<35:05,  6.42s/it]  2%|▏         | 8/335 [01:04<34:08,  6.27s/it]  3%|▎         | 9/335 [01:10<32:03,  5.90s/it]  3%|▎         | 10/335 [01:15<30:50,  5.69s/it]  3%|▎         | 11/335 [01:20<29:24,  5.45s/it]  4%|▎         | 12/335 [01:25<29:02,  5.39s/it]  4%|▍         | 13/335 [01:30<28:56,  5.39s/it]  4%|▍         | 14/335 [01:35<28:06,  5.25s/it]  4%|▍         | 15/335 [01:40<27:25,  5.14s/it]  5%|▍         | 16/335 [01:45<27:04,  5.09s/it]  5%|▌         | 17/335 [01:50<26:58,  5.09s/it]  5%|▌         | 18/335 [01:55<26:03,  4.93s/it]  6%|▌         | 19/335 [02:00<25:44,  4.89s/it]  6%|▌         | 20/335 [02:05<26:08,  4.98s/it]  6%|▋         | 21/335 [02:10<25:49,  4.94s/it]  7%|▋         | 22/335 [02:14<25:39,  4.92s/it]  7%|▋         | 23/335 [02:19<25:20,  4.87s/it]  7%|▋         | 24/335 [02:24<25:22,  4.90s/it]  7%|▋         | 25/335 [02:29<25:39,  4.96s/it]                                                  7%|▋         | 25/335 [02:29<25:39,  4.96s/it]  8%|▊         | 26/335 [02:34<25:51,  5.02s/it]  8%|▊         | 27/335 [02:40<25:52,  5.04s/it]  8%|▊         | 28/335 [02:44<25:33,  4.99s/it]  9%|▊         | 29/335 [02:49<25:32,  5.01s/it]